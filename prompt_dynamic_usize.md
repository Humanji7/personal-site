# üéØ Task: Dynamic uSize (Particle Density Based on Tension)

## –ö–æ–Ω—Ç–µ–∫—Å—Ç
–ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—Å–º. `particle_test_results.md`) —Ä–µ—à–µ–Ω–æ:
- **5000 —á–∞—Å—Ç–∏—Ü** ‚Äî –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞
- **uSize** ‚Äî –º–æ–∂–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –ø—Ä–∏ tension –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∞ "—Å–∂–∞—Ç–∏—è/–Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è"

## –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

### –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞
```
Peace (0)    ‚Üí uSize = 6.0  (—Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ, "–¥—ã—à–∏—Ç —Å–≤–æ–±–æ–¥–Ω–æ")
Tension (1)  ‚Üí uSize = 7.5  (–ø–ª–æ—Ç–Ω–µ–µ, "—Å–∂–∏–º–∞–µ—Ç—Å—è –æ—Ç –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è")
```

–°—Ñ–µ—Ä–∞ **–≤–∏–∑—É–∞–ª—å–Ω–æ —É–ø–ª–æ—Ç–Ω—è–µ—Ç—Å—è** –∫–æ–≥–¥–∞ –Ω–µ—Ä–≤–Ω–∏—á–∞–µ—Ç ‚Äî –∫–∞–∫ –∂–∏–≤–æ–µ —Å—É—â–µ—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –∏–Ω—Å—Ç–∏–Ω–∫—Ç–∏–≤–Ω–æ "—Å—ä—ë–∂–∏–≤–∞–µ—Ç—Å—è" –ø—Ä–∏ —É–≥—Ä–æ–∑–µ.

## –ó–∞–¥–∞—á–∏

### 1. –î–æ–±–∞–≤–∏—Ç—å dynamic uSize –≤ Sphere.js
```javascript
// –í update() –ø–æ—Å–ª–µ —Ä–∞—Å—á—ë—Ç–∞ colorProgress
const baseSize = 6.0;
const tensionSize = 1.5;  // +1.5 –ø—Ä–∏ –ø–æ–ª–Ω–æ–º tension
const targetSize = baseSize + this.currentColorProgress * tensionSize;

// –ü–ª–∞–≤–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ (smoothing)
this.currentSize = THREE.MathUtils.lerp(this.currentSize, targetSize, delta * 2.0);
this.particleSystem.material.uniforms.uSize.value = this.currentSize;
```

### 2. –°–≤—è–∑–∫–∞ —Å gestureReaction
- **strokeCalm** ‚Üí —É–º–µ–Ω—å—à–∞–µ—Ç uSize –±—ã—Å—Ç—Ä–µ–µ
- **trembleNervous** ‚Üí uSize –±–ª–∏–∂–µ –∫ –º–∞–∫—Å–∏–º—É–º—É

### 3. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ç—é–Ω–∏–Ω–≥–∞
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|----------|
| `baseSize` | 6.0 | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä (Peace) |
| `maxSizeBoost` | 1.5 | –î–æ–±–∞–≤–∫–∞ –ø—Ä–∏ tension=1 |
| `sizeSmoothSpeed` | 2.0 | –°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ—Ö–æ–¥–∞ |

## –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
1. –ü—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –∫—É—Ä—Å–æ—Ä–∞ —á–∞—Å—Ç–∏—Ü—ã –¥–æ–ª–∂–Ω—ã **–≤–∏–∑—É–∞–ª—å–Ω–æ —Å–º—ã–∫–∞—Ç—å—Å—è**
2. –ü—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ ‚Äî **—Ä–∞–∑—Ä–µ–∂–∞—Ç—å—Å—è** –æ–±—Ä–∞—Ç–Ω–æ
3. Stroke gesture –¥–æ–ª–∂–µ–Ω **—É—Å–∫–æ—Ä—è—Ç—å** –≤–æ–∑–≤—Ä–∞—Ç –∫ base size
4. FPS –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è ‚â•50

## Debug API
```javascript
// –¢–µ–∫—É—â–∏–π size
window.app.particleSystem.material.uniforms.uSize.value

// Manual override
window.app.sphere.currentSize = 7.0
```

---

**–§–∏–ª–æ—Å–æ—Ñ–∏—è:** –°—Ñ–µ—Ä–∞ "–¥—ã—à–∏—Ç –ø–æ–ª–Ω–æ–π –≥—Ä—É–¥—å—é" –≤ –ø–æ–∫–æ–µ, –∏ "—Å–∂–∏–º–∞–µ—Ç—Å—è" –ø—Ä–∏ —Å—Ç—Ä–µ—Å—Å–µ ‚Äî –∫–∞–∫ –∂–∏–≤–æ–µ —Å—É—â–µ—Å—Ç–≤–æ.
